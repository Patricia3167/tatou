from hypothesis import given, strategies as st
import requests

API_URL = "http://server:5000/api"
HEADERS = {"Authorization": "Bearer VALID_TEST_TOKEN"}  # If needed

@given(
    email=st.text(min_size=0, max_size=128),
    login=st.text(min_size=0, max_size=64),
    password=st.text(min_size=0, max_size=128)
)
def test_fuzz_create_user_inputs(email, login, password):
    payload = {
        "email": email,
        "login": login,
        "password": password
    }
    r = requests.post(f"{API_URL}/create-user", json=payload, headers=HEADERS)

    # Acceptable outcomes
    assert r.status_code in (201, 400, 409), f"Unexpected status {r.status_code} for input: {payload}"